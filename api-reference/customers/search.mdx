---
title: "Search Customer"
api: "GET /loyalty/customers/search"
description: "Find existing customers using WhatsApp, email, CPF, or Zupy member code with priority-based matching"
---

## Overview

This endpoint locates existing customers in the loyalty program using multiple identification criteria. The search follows a priority order to return the most specific match first, making it ideal for customer lookup during transactions or support interactions.

## Authentication

<ParamField header="Authorization" type="string" required>
  Bearer token for API authentication
  ```
  Authorization: Bearer {your_api_key}
  ```
</ParamField>

## Query Parameters

<Note>
  **Priority Order**: If multiple parameters are provided, the search uses this priority:
  1. Member Code (most specific)
  2. WhatsApp (primary identifier)  
  3. Email (secondary identifier)
  4. CPF (document-based)
</Note>

<ParamField query="member_code" type="string">
  Zupy member code (highest priority)
  ```
  ZP-4F95FB0A
  ```
</ParamField>

<ParamField query="whatsapp" type="string">
  WhatsApp number in international format
  ```
  +5511965958122 or 11965958122
  ```
</ParamField>

<ParamField query="email" type="string">
  Customer's email address
  ```
  joao@email.com
  ```
</ParamField>

<ParamField query="cpf" type="string">
  Customer's CPF (with or without formatting)
  ```
  12345678901 or 123.456.789-01
  ```
</ParamField>

## Response

<ResponseField name="member_id" type="string">
  Unique Zupy customer identifier (format: ZP-XXXXXXXX)
</ResponseField>

<ResponseField name="whatsapp" type="string">
  WhatsApp number in international format
</ResponseField>

<ResponseField name="whatsapp_verified" type="boolean">
  Whether WhatsApp number has been verified
</ResponseField>

<ResponseField name="email" type="string">
  Customer's email address
</ResponseField>

<ResponseField name="email_verified" type="boolean">
  Whether email address has been verified
</ResponseField>

<ResponseField name="name" type="string">
  Customer's full name
</ResponseField>

<ResponseField name="cpf" type="string">
  CPF in formatted display (000.000.000-00)
</ResponseField>

<ResponseField name="cpf_verified" type="boolean">
  Whether CPF has been verified
</ResponseField>

<ResponseField name="status" type="string">
  Profile completion status
  ```
  basic_profile | partial_profile | complete_profile
  ```
</ResponseField>

<ResponseField name="created_at" type="string">
  Customer registration timestamp (ISO 8601)
</ResponseField>

<ResponseField name="updated_at" type="string">
  Last profile update timestamp (ISO 8601)
</ResponseField>

<ResponseField name="tier" type="string">
  Current loyalty tier
  ```
  default | bronze | silver | gold | platinum | vip
  ```
</ResponseField>

<ResponseField name="current_points" type="integer">
  Current available points balance
</ResponseField>

<ResponseField name="points_earned" type="integer">
  Total points earned historically
</ResponseField>

<ResponseField name="points_spent" type="integer">
  Total points redeemed historically
</ResponseField>

<ResponseField name="rfm_classification" type="string">
  RFM-based customer segment
  ```
  New Customer | Loyal Customer | Champion | At Risk | Lost
  ```
</ResponseField>

<ResponseField name="rfm_segment" type="string">
  Detailed RFM segment description
</ResponseField>

<ResponseField name="rfm_cluster" type="integer">
  Machine learning cluster ID (0-10)
</ResponseField>

<ResponseField name="rfm_score" type="object">
  Detailed RFM scoring breakdown
  
  <Expandable title="RFM Score Object">
    <ResponseField name="recency" type="integer">
      Recency score (1-5, higher = more recent)
    </ResponseField>
    
    <ResponseField name="frequency" type="integer">
      Frequency score (1-5, higher = more frequent)
    </ResponseField>
    
    <ResponseField name="monetary" type="integer">
      Monetary score (1-5, higher = higher value)
    </ResponseField>
    
    <ResponseField name="total" type="integer">
      Combined RFM score (3-15)
    </ResponseField>
    
    <ResponseField name="segment" type="string">
      Calculated customer segment
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="last_activity_date" type="string">
  Date of most recent activity (ISO 8601)
</ResponseField>

<ResponseField name="last_transaction_date" type="string">
  Date of most recent points transaction (ISO 8601)
</ResponseField>

<ResponseField name="transaction_count" type="integer">
  Total number of loyalty transactions
</ResponseField>

<ResponseField name="total_spent" type="number">
  Total amount spent across all transactions (BRL)
</ResponseField>

<ResponseField name="days_since_signup" type="integer">
  Days since customer first joined loyalty program
</ResponseField>

<ResponseField name="lifetime_value" type="number">
  Calculated customer lifetime value (BRL)
</ResponseField>

<ResponseField name="average_order_value" type="number">
  Average transaction value (BRL)
</ResponseField>

## Example Request

<CodeGroup>
```bash cURL
curl -X GET "https://api.zupy.com/v1/loyalty/customers/search?whatsapp=+5511965958122" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json"
```

```javascript JavaScript
const response = await fetch('https://api.zupy.com/v1/loyalty/customers/search?whatsapp=+5511965958122', {
  method: 'GET',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  }
});

const customer = await response.json();
console.log(customer);
```

```python Python
import requests

url = "https://api.zupy.com/v1/loyalty/customers/search"
params = {"whatsapp": "+5511965958122"}
headers = {
    "Authorization": "Bearer YOUR_API_KEY",
    "Content-Type": "application/json"
}

response = requests.get(url, params=params, headers=headers)
customer = response.json()
print(customer)
```

```php PHP
<?php
$url = "https://api.zupy.com/v1/loyalty/customers/search?whatsapp=" . urlencode("+5511965958122");

$headers = [
    "Authorization: Bearer YOUR_API_KEY",
    "Content-Type: application/json"
];

$response = file_get_contents($url, false, stream_context_create([
    'http' => [
        'method' => 'GET',
        'header' => implode("\r\n", $headers)
    ]
]));

$customer = json_decode($response, true);
print_r($customer);
?>
```
</CodeGroup>

## Example Response

<CodeGroup>
```json 200 - Customer Found
{
  "member_id": "ZP-4F95FB0A",
  "whatsapp": "+5511965958122",
  "whatsapp_verified": true,
  "email": "joao@email.com",
  "email_verified": false,
  "name": "João Silva",
  "cpf": "123.456.789-01",
  "cpf_verified": false,
  "status": "partial_profile",
  "created_at": "2025-08-15T10:30:00Z",
  "updated_at": "2025-08-20T14:22:00Z",
  "tier": "silver",
  "current_points": 847,
  "points_earned": 2150,
  "points_spent": 1303,
  "rfm_classification": "Loyal Customer",
  "rfm_segment": "Loyal Customers",
  "rfm_cluster": 3,
  "rfm_score": {
    "recency": 4,
    "frequency": 5,
    "monetary": 4,
    "total": 13,
    "segment": "Loyal Customer"
  },
  "last_activity_date": "2025-08-20T14:22:00Z",
  "last_transaction_date": "2025-08-20T14:22:00Z",
  "transaction_count": 12,
  "total_spent": 420.00,
  "days_since_signup": 42,
  "lifetime_value": 420.00,
  "average_order_value": 35.00
}
```

```json 404 - Customer Not Found
{
  "error": "customer_not_found",
  "message": "Nenhum cliente encontrado com os critérios fornecidos"
}
```

```json 400 - Invalid Parameters
{
  "error": "invalid_parameters",
  "message": "At least one search parameter is required",
  "details": {
    "supported_parameters": ["member_code", "whatsapp", "email", "cpf"]
  }
}
```
</CodeGroup>

## Search Priority Logic

When multiple parameters are provided, only the highest priority parameter is used:

```javascript
// Example: Both member_code and whatsapp provided
GET /loyalty/customers/search?member_code=ZP-4F95FB0A&whatsapp=+5511965958122

// Result: Only member_code is used for search (highest priority)
```

## Profile Status Levels

<ResponseField name="basic_profile">
  **Basic Profile**: Only WhatsApp verified, minimal information
</ResponseField>

<ResponseField name="partial_profile">
  **Partial Profile**: Some information provided but not fully verified
</ResponseField>

<ResponseField name="complete_profile">
  **Complete Profile**: All required information provided and verified
</ResponseField>

## RFM Segment Definitions

<ResponseField name="Champion">
  **Champions**: Recent buyers, frequent purchasers, high spenders
</ResponseField>

<ResponseField name="Loyal Customer">
  **Loyal Customers**: Regular buyers with consistent purchase behavior
</ResponseField>

<ResponseField name="New Customer">
  **New Customers**: Recent first-time buyers with potential
</ResponseField>

<ResponseField name="At Risk">
  **At Risk**: Previously good customers who haven't purchased recently
</ResponseField>

<ResponseField name="Lost">
  **Lost Customers**: Haven't purchased in a long time
</ResponseField>

## Error Codes

| Code | Description |
|------|-------------|
| `customer_not_found` | No customer matches the search criteria |
| `invalid_parameters` | No search parameters provided |
| `invalid_format` | Parameter format is invalid (e.g., malformed WhatsApp) |
| `unauthorized` | Missing or invalid API credentials |

## Rate Limits

- **Production**: 500 requests per minute
- **Staging**: 100 requests per minute

<Tip>
  **Performance Tip**: Member code searches are fastest, followed by WhatsApp. Use the most specific identifier available for optimal performance.
</Tip>